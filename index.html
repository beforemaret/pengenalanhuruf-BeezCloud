<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Belajar Huruf ABC</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .dotted-letter { stroke: #94a3b8; stroke-width: 3; stroke-dasharray: 8,4; fill: none; opacity: 0.7; }
        .solid-letter { stroke: #1e40af; stroke-width: 4; fill: none; opacity: 0; transition: opacity 0.3s ease; }
        .letter-container:hover .solid-letter { opacity: 1; }
        .nav-button { transition: all 0.3s ease; }
        .nav-button:hover { transform: scale(1.05); }
        .example-card { transition: transform 0.3s ease; }
        .example-card:hover { transform: translateY(-5px); }
        @media (max-width: 768px) {
            .nav-button { width: 2.5rem; height: 2.5rem; font-size: 0.875rem; }
            .example-card { padding: 1rem; }
            .example-card h4 { font-size: 1.25rem; }
            .example-card .text-4xl { font-size: 2rem; }
            .mobile-stack { flex-direction: column; gap: 0.75rem; }
            .mobile-center { text-align: center; }
            .canvas-container { overflow-x: auto; }
            #writingCanvas { max-width: 100%; height: auto; }
        }
        @media (max-width: 480px) {
            .nav-button { width: 2.25rem; height: 2.25rem; font-size: 0.75rem; }
            .example-card { padding: 0.75rem; }
            .example-card h4 { font-size: 1.125rem; }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-purple-50 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-6 px-2">
            <h1 class="text-3xl md:text-4xl font-bold text-blue-800 mb-2">üéì Belajar Huruf ABC</h1>
            <p class="text-sm md:text-base text-gray-600">Belajar menulis huruf dengan cara yang menyenangkan!</p>
            <!-- Mobile Audio Activation Button -->
            <div id="audioActivation" class="mt-4 md:hidden">
                <button onclick="activateAudioForMobile()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-full font-semibold text-sm shadow-lg animate-pulse">
                    üîä Aktifkan Suara
                </button>
                <p class="text-xs text-gray-500 mt-1">Tekan untuk mengaktifkan suara di handphone</p>
            </div>
        </div>

        <!-- Navigation -->
        <div class="flex flex-wrap justify-center gap-1 md:gap-2 mb-6 md:mb-8 px-2">
            <div id="letterNav" class="flex flex-wrap justify-center gap-1 md:gap-2 max-w-full"></div>
        </div>

        <!-- Main Content -->
        <div class="max-w-6xl mx-auto px-2">
            <div id="letterContent" class="bg-white rounded-xl md:rounded-2xl shadow-xl p-4 md:p-8"></div>
        </div>
    </div>

    <script>
        /* === Data Huruf Sama Seperti Versi Lama (Dipotong di sini untuk singkat) === */
        /* SALIN SELURUH OBJECT letterData DARI KODE LAMA DI SINI */
        const letterData = { /* ... seluruh data A-Z tetap sama ... */ };

        let currentLetter = 'A';

        function createNavigation() {
            const nav = document.getElementById('letterNav');
            const letters = Object.keys(letterData);
            letters.forEach(letter => {
                const button = document.createElement('button');
                button.className = 'nav-button w-12 h-12 rounded-full bg-blue-500 text-white font-bold text-lg hover:bg-blue-600 shadow-lg';
                button.textContent = letter;
                button.onclick = () => showLetter(letter);
                nav.appendChild(button);
            });
        }

        function showLetter(letter) {
            currentLetter = letter;
            const data = letterData[letter];
            const content = document.getElementById('letterContent');

            document.querySelectorAll('.nav-button').forEach(btn => {
                btn.className = btn.textContent === letter 
                    ? 'nav-button w-12 h-12 rounded-full bg-purple-600 text-white font-bold text-lg shadow-lg transform scale-110'
                    : 'nav-button w-12 h-12 rounded-full bg-blue-500 text-white font-bold text-lg hover:bg-blue-600 shadow-lg';
            });

            content.innerHTML = `
                <div class="grid lg:grid-cols-2 gap-4 md:gap-8">
                    <!-- kiri: latihan huruf -->
                    <div class="space-y-4 md:space-y-6">
                        <div class="text-center">
                            <h2 class="text-4xl md:text-6xl font-bold text-purple-700 mb-2">${letter}</h2>
                            <p class="text-sm md:text-base text-gray-600">Huruf ${letter}</p>
                        </div>
                        <div class="bg-gray-50 rounded-xl p-4 md:p-6">
                            <h3 class="text-lg md:text-xl font-semibold text-gray-800 mb-3 md:mb-4">‚úèÔ∏è Latihan Menulis</h3>
                            <div class="letter-container bg-white rounded-lg p-3 md:p-4 border-2 border-dashed border-gray-300 mb-3 md:mb-4">
                                <svg width="150" height="150" viewBox="0 0 200 200" class="mx-auto md:w-[200px] md:h-[200px]">
                                    <path d="${data.path}" class="dotted-letter"/>
                                    <path d="${data.path}" class="solid-letter"/>
                                </svg>
                                <p class="text-center text-xs md:text-sm text-gray-500 mt-2">Contoh bentuk huruf ${letter}</p>
                            </div>
                            <div class="bg-white rounded-lg p-3 md:p-4 border-2 border-blue-300">
                                <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center mb-3 gap-2">
                                    <p class="text-xs md:text-sm font-medium text-gray-700 mobile-center">Tulis huruf ${letter} di sini:</p>
                                    <button onclick="clearCanvas()" class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-xs md:text-sm font-medium self-center sm:self-auto">
                                        üóëÔ∏è Hapus
                                    </button>
                                </div>
                                <div class="canvas-container">
                                    <canvas id="writingCanvas" width="280" height="180" class="border-2 border-gray-200 rounded-lg mx-auto block cursor-crosshair bg-yellow-50 max-w-full" style="touch-action: none;"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- kanan: contoh kata -->
                    <div class="space-y-4 md:space-y-6">
                        <div class="text-center">
                            <h3 class="text-xl md:text-2xl font-semibold text-gray-800 mb-3 md:mb-4">üéØ Contoh Kata</h3>
                        </div>
                        <div class="grid gap-3 md:gap-4">
                            ${data.examples.map(example => `
                                <div class="example-card bg-gradient-to-r from-yellow-50 to-orange-50 rounded-xl p-4 md:p-6 border border-yellow-200 shadow-md">
                                    <div class="flex items-center space-x-3 md:space-x-4 mobile-stack sm:flex-row">
                                        <div class="text-3xl md:text-4xl flex-shrink-0">${example.emoji}</div>
                                        <div class="flex-1 min-w-0">
                                            <h4 class="text-xl md:text-2xl font-bold text-gray-800 truncate">${example.name}</h4>
                                            <span class="inline-block px-2 md:px-3 py-1 rounded-full text-xs md:text-sm font-medium ${
                                                example.type === 'hewan' ? 'bg-green-100 text-green-800' :
                                                example.type === 'buah' ? 'bg-red-100 text-red-800' :
                                                'bg-blue-100 text-blue-800'
                                            }">${example.type}</span>
                                        </div>
                                        <div class="flex items-center space-x-2 md:space-x-3 flex-shrink-0">
                                            <button onclick="playSound('${example.name}')" class="bg-blue-500 hover:bg-blue-600 text-white p-2 md:p-3 rounded-full transition-all hover:scale-110 shadow-lg">üîä</button>
                                            <div class="text-3xl md:text-4xl font-bold text-purple-600">${letter}</div>
                                        </div>
                                    </div>
                                </div>`).join('')}
                        </div>
                    </div>
                </div>`;
            setTimeout(initCanvas, 100);
        }

        function nextLetter() { const letters = Object.keys(letterData); showLetter(letters[(letters.indexOf(currentLetter)+1)%letters.length]); }
        function previousLetter() { const letters = Object.keys(letterData); showLetter(letters[(letters.indexOf(currentLetter)-1+letters.length)%letters.length]); }

        /* ==== Canvas ==== */
        let isDrawing=false, canvas, ctx;
        function initCanvas(){
            canvas=document.getElementById('writingCanvas');
            if(!canvas) return;
            const isMobile=window.innerWidth<768;
            canvas.width=isMobile?Math.min(280,window.innerWidth-60):300;
            canvas.height=isMobile?160:200;
            ctx=canvas.getContext('2d');
            ctx.strokeStyle='#3b82f6';
            ctx.lineWidth=isMobile?3:4;
            ctx.lineCap='round';
            ctx.lineJoin='round';
            canvas.onmousedown=startDrawing;
            canvas.onmousemove=draw;
            canvas.onmouseup=stopDrawing;
            canvas.onmouseout=stopDrawing;
            canvas.addEventListener('touchstart',handleTouch);
            canvas.addEventListener('touchmove',handleTouch);
            canvas.addEventListener('touchend',stopDrawing);
        }
        function startDrawing(e){isDrawing=true;const r=canvas.getBoundingClientRect();ctx.beginPath();ctx.moveTo(e.clientX-r.left,e.clientY-r.top);}
        function draw(e){if(!isDrawing) return;const r=canvas.getBoundingClientRect();ctx.lineTo(e.clientX-r.left,e.clientY-r.top);ctx.stroke();}
        function stopDrawing(){isDrawing=false;}
        function handleTouch(e){e.preventDefault();const t=e.touches[0];const m=new MouseEvent(e.type==='touchstart'?'mousedown':e.type==='touchmove'?'mousemove':'mouseup',{clientX:t.clientX,clientY:t.clientY});canvas.dispatchEvent(m);}
        function clearCanvas(){if(ctx) ctx.clearRect(0,0,canvas.width,canvas.height);}

        /* ==== Speech ==== */
        let availableVoices=[], audioInitialized=false;
        const isMobileDevice=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

        function loadVoices(callback){
            function updateVoices(){
                availableVoices=speechSynthesis.getVoices();
                if(availableVoices.length>0 && typeof callback==='function'){callback();}
            }
            updateVoices();
            speechSynthesis.onvoiceschanged=updateVoices;
        }

        function getBestVoice(){
            const priorities=[
                v=>v.lang==='id-ID'&&v.name.includes('Google'),
                v=>v.lang==='id-ID'&&v.name.includes('Microsoft'),
                v=>v.lang==='id-ID',
                v=>v.lang==='ms-MY',
                v=>v.lang==='en-US'&&v.name.includes('Google'),
                v=>true];
            for(const p of priorities){const voice=availableVoices.find(p);if(voice)return voice;}
            return null;
        }

        function activateAudioForMobile(){
            if(isMobileDevice){
                speechSynthesis.cancel();
                speechSynthesis.resume();
                const dummy=new SpeechSynthesisUtterance("a");
                dummy.volume=0;
                dummy.onend=()=>{audioInitialized=true;document.getElementById('audioActivation').style.display='none';console.log("‚úÖ Audio aktif di HP");};
                speechSynthesis.speak(dummy);
            }
        }

        function playSound(word){
            if(isMobileDevice && !audioInitialized) activateAudioForMobile();
            if(!('speechSynthesis' in window)) return;
            function speakNow(){
                speechSynthesis.cancel();
                setTimeout(()=>{
                    const utterance=new SpeechSynthesisUtterance(word);
                    const bestVoice=getBestVoice();
                    if(bestVoice) utterance.voice=bestVoice;
                    utterance.lang=bestVoice?.lang||'id-ID';
                    utterance.rate=isMobileDevice?0.9:0.8;
                    utterance.pitch=1.1;
                    utterance.volume=1;
                    speechSynthesis.speak(utterance);
                },100);
            }
            if(availableVoices.length===0){loadVoices(speakNow);} else {speakNow();}
        }

        /* ==== Init ==== */
        if('speechSynthesis' in window){
            loadVoices();
            if(!isMobileDevice){document.getElementById('audioActivation').style.display='none';}
        }
        window.addEventListener('resize',()=>setTimeout(initCanvas,100));
        createNavigation(); showLetter('A'); setTimeout(initCanvas,100);
    </script>
</body>
</html>
